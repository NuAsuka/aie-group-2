# HW07 – Report

> Файл: `homeworks/HW07/report.md`  
> Важно: не меняйте названия разделов (заголовков). Заполняйте текстом и/или вставляйте результаты.

## 1. Datasets

- S07-hw-dataset-01.csv
- S07-hw-dataset-02.csv
- S07-hw-dataset-03.csv

### 1.1 Dataset A

- Файл: `S07-hw-dataset-01.csv`
- Размер: (12000, 9)
- Признаки: числовые
- Пропуски: нет
- "Подлости" датасета: разные шкалы, выбросы

### 1.2 Dataset B

- Файл: `S07-hw-dataset-02.csv`
- Размер: (8000, 4)
- Признаки: числовые
- Пропуски: нет
- "Подлости" датасета: шумовой признак, разные шкалы, выбросы.

### 1.3 Dataset C

- Файл: `S07-hw-dataset-03.csv`
- Размер: (15000, 5)
- Признаки: числовые
- Пропуски: нет
- "Подлости" датасета: разные шкалы, выбросы

## 2. Protocol

Препроцессинг для всех датасетов был реализован через scaling, PCA (на этапе визуализации лучшего решения модели)

Поиск гиперпараметров для KMEANS реализовывался через сетку от 2 до 20.
Поиск гиперпараметров для DBSCAN реализовывался через сетку для EPS от 0.5 до 3.5 с шагом 0.5 и через сетку для min samples с значениями 3, 5, 10.

При выборе лучшей модели учитывалась метрика silhouette и Davies-Bouldin. Дополнительно просмтр PCA визаулизации.

Высчитваались метрики silhouette, Davies-Bouldin, Calinski-Harabasz для всех моделей и датасетов. Для DBSCAN при наличии шума метрики считались на точках, которые не являются шумом в DBSCAN.

Визуализация включался себя графики KMEANS (silhouette vs k, inertia vs k) и PCA(2D) для лучшей модели каждого датасета.

## 3. Models

Для каждого датасета считались следующие модели:
- KMeans (поиск `k`, фиксировали `random_state`, `n_init`)
- DBSCAN (`eps`, `min_samples`)

## 4. Results

Для каждого датасета – краткая сводка результатов.

### 4.1 Dataset A

- Лучший метод: kmeans
- Параметры: 2 кластера
- Метрики:
  - "silhouette": 0.5216395622404242,
  - "davies_bouldin": 0.6853295219054459,
  - "calinski_harabasz": 11786.95462267153
- Данное решение выглядит разумно для этого датасета, поскольку обеспечивается максимальный silhouette

### 4.2 Dataset B

- Лучший метод: dbscan
- Параметры: 
  - "eps": 0.5,
  - "min_samples": 10
- Метрики:
  - "silhouette": 0.25120225459401474,
  - "davies_bouldin": 0.7420731639720546,
  - "calinski_harabasz": 26.168575636304777
- Доля шума 6.36%, что приемлемо.
- Данное решение выглядит разумно для этого датасета, поскольку silhouette не критично мал по сравнению с kmeans, но при этом метрика davies bouldin намного лучше. PCA 2d визуализация также лучше выглядит для dbscan.

### 4.3 Dataset C

- Лучший метод: kmeans
- Параметры: 3 кластера
- Метрики:
  - "silhouette": 0.31553248183109267,
  - "davies_bouldin": 1.1577832240211114,
  - "calinski_harabasz": 6957.158106946778
- Данное решение выглядит разумно для этого датасета, поскольку silhouette максимален, как и davies bouldin.

## 5. Analysis

### 5.1 Сравнение алгоритмов (важные наблюдения)

Kmeans ломается при сложных формах кластеров и разной плотности кластеров. Также kmeans ломается при большом количестве шума в данных, неоптимальном количестве кластеров и высокой размерности

DBSCAN выйгрывает по сравнению с kmeans, когда данные имеют разную плотность в разных участках.

Сильнее всего влияло на результат мастабирование и плотность данных

### 5.2 Устойчивость (обязательно для одного датасета)

Проверку устойчивости реализована через 5 запусков KMeans по разным seed на первом датасете с оценкой похожести разбиений по ARI между результатами.
Проверка устойчивости дала результат ARI равной 1, что говорит о высокой устойчивости модели на данном датасете.
Модель устойчива, поскольку seed не влияет на итоговый результат.

### 5.3 Интерпретация кластеров

Для первого датасета после кластеризации получено два кластера. Анализ медиан показал, что кластер 0 представляет собой группу объектов с высокими значениями по признакам f01, f02, f05, f06, но резко сниженным значением f04. Кластер 1, напротив, характеризуется умеренными или низкими значениями по тем же признакам, но положительным f04.

Для второго датасета после кластеризации получено два кластера. Анализ медиан показал, что кластер 0 для всех признаков характеризуется меньшей медианой по сравнению с кластером 1.

Для третьего датасета после кластеризации получено три кластера. 
Анализ медиан показал, что кластер 0 представляет собой группу объектов с высокими положительными значениями по обоим исходным признакам x1 и x2, умеренно положительным f_corr и слегка отрицательным f_noise. 
Кластер 1 характеризуется умеренным x1, но отрицательным x2, при этом имеет наиболее высокое значение f_corr среди всех кластеров и близкий к нулю f_noise. 
Кластер 2 выделяется отрицательным x1, положительным x2 и резко отрицательным f_corr, в то время как f_noise остаётся близким к нулю.

## 6. Conclusion

1. Разные модели кластеризации подходят для разных датасетов, нет идеальной модели для всех данных.
2. По одной метрике, например silhouette, нельзя судить о качестве кластеризации. Нужно ещё как минимум две метрики.
3. Unsupervised-эксперимент должен быть хорошо структурно продуман для удобного переиспользования. 
4. Unsupervised-эксперимент должен оставлять после себя "артифакты", причём такие, чтобы было удобно получить выводы без повторного запуска: графики, json таблицы, параметры лучших моделей.
